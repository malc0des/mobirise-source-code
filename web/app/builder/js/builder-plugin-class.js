var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,e,g){b instanceof String&&(b=String(b));for(var h=b.length,k=0;k<h;k++){var l=b[k];if(e.call(g,l,k,b))return{i:k,v:l}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,e,g){b!=Array.prototype&&b!=Object.prototype&&(b[e]=g.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,e,g,h){if(e){g=$jscomp.global;b=b.split(".");for(h=0;h<b.length-1;h++){var k=b[h];k in g||(g[k]={});g=g[k]}b=b[b.length-1];h=g[b];e=e(h);e!=h&&null!=e&&$jscomp.defineProperty(g,b,{configurable:!0,writable:!0,value:e})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,g){return $jscomp.findInternal(this,b,g).v}},"es6","es3");
(function(b,e){function g(a){return a.is("[mbr-buttons], [mbr-menu]")}function h(a){var d=b.summernote.eventHandler;a=b.summernote.core.dom.makeLayoutInfo(a);d.updateStyleInfo(d.modules.editor.currentStyle(a.editable()),a)}function k(a,b){if(1<a.find("li").length)return!0;var c="",f=0;e.eachStylesForNode(b,function(a,b){c+='<li><a data-event="mbrStyle" href="javascript:void(0);"data-value="'+a+'"><span class="'+a+'">'+b+"</span>"+e.applyFilter("buttonFontSiteStyleIcon","")+"</a></li>";f=Math.max(f,
b.length)});if(!c)return!1;b=Math.min(200,18*f/2+69);a=a.find("ul");a.html(c);a.css("min-width",b+"px");return!0}function l(a,d){a=b(a).closest("[data-class-var]");if(a.attr("data-class-var")!=d){var c=g(a)?a.find("a"):a,f=[];e.eachStylesForNode(a,function(a){f.push(a)});f.length&&c.removeClass(f.join(" "));c.addClass(d);a.attr("data-class-var",d).trigger(b.Event("change-theme-style",{themeStyle:d}))}}rivets.binders["class-var"]={bind:function(a,d){var c=this,f=b(a);f.off("blur.style").on("blur.style",
g(f)?"a":null,function(a){c.observer.setValue(f.attr("data-class-var"))})},unbind:function(a,d){b(a).off("blur.style");b(a).removeAttr("data-class-var")},routine:function(a,d){var c=this.getValue(a);a=b(a).attr("data-class-var",d);g(a)&&(a=a.find("a"));c&&a.removeClass(c);d&&a.addClass(d)},getValue:function(a){return b(a).attr("data-class-var")}};var m,n,p={name:"mbrStyle",className:"note-current-mbrStyle",title:"Font",label:"[...]",itemsHtml:"",onUpdate:function(a,d,c){a=b(a).closest("[mbr-class-var]");
if(c.range&&c.range.isCollapsed()||g(a))if(k(d,a)){d.show();var f=a.attr("data-class-var");f||e.eachStylesForNode(a,function(c){b(a).hasClass(c)&&(f=c)});d.find("li").removeClass("selected");c=d.find('li [data-value="'+f+'"]');c.parent().addClass("selected");d.find(".mbr-icon-paint-brush").tooltip({container:"body",trigger:"hover",placement:"top"});d.find(".note-current-mbrStyle").attr("class","note-current-mbrStyle "+f).html(c.text())}else d.hide(),!a.length||m===c.range.so&&n===c.range.eo||(h(a),
m=c.range.so,n=c.range.eo);else d.hide(),!a.length||m===c.range.so&&n===c.range.eo||(h(a),m=c.range.so,n=c.range.eo)},onAction:function(a,d,c){c.editable().focus();if(b(a.target).is(".mbr-icon-paint-brush"))setTimeout(function(){var a=c.editor().closest("[data-class-var]").attr("data-class-var");e.APP.openThemeSettings();e.APP.ToogleThemeSettings.target.$elm.find('.app-layer-group[data-group-name="'+a+'"]').addClass("selected")},100);else if(a=b(a.target).closest("a").attr("data-value"))l(c.editable(),
a),setTimeout(function(){var a=b.summernote.eventHandler;a.updateStyleInfo(a.modules.editor.currentStyle(c.editable()),c)},250)}},q=b.summernote.renderer.getTemplate();e.regExtension({name:"plugin-element-class",global:{registeredSummernoteButtons:[],regSummernoteButton:function(a){a.event=a.event||a.name;var d=a.name,c={name:a.name,buttons:{},events:{},langs:{"en-US":{}}};c.buttons[a.name]=function(b,c){c='<span class="'+a.className+'">'+a.label+"</span>";b={title:b[d][a.name],hide:a.hide||!1,event:a.event,
name:a.name};"itemsHtml"in a&&(b.dropdown='<ul class="dropdown-menu note-check">'+a.itemsHtml+"</ul>");if(a.onInit)a.onInit(b);return q.button(c,b)};c.events[a.name]=function(b,c,d){if(a.onAction)a.onAction(b,c,d)};c.langs["en-US"][d]={};c.langs["en-US"][d][a.name]=a.title;b.summernote.addPlugin(c);this.registeredSummernoteButtons.push(a)},eachStylesForNode:function(a,d){a=b(a).closest("[mbr-class-var]");var c="window mbrAppCore APP theme params theme settings".split(" ");for(var f=window,e=0;f&&
e<c.length;e++)f=f[c[e]];c=f||[];f=[];for(var g in c)(e=c[g])&&"group"==e.type&&"rule"in e&&a.is(e.rule)&&(!e.name||0<=f.indexOf(e.name)?console.warn("Wrong name of theme style from theme.settings["+g+"]: {"+e.name+","+e.title+"}. Passed..."):(f.push(e.name),d(e.name,e.title||e.name)))}},events:{load:function(){e.addFilter("cleanHTMLplease",function(a,b){a.find("[data-class-var]").removeAttr("data-class-var");return a});e.addFilter("summernoteMakePopover",function(a,b){a.unshift(["mbrStyle",["mbrStyle"]]);
return a});e.addFilter("summernoteOptions",function(a,d){d.closest("[data-class-var]").length&&(a.customToolbar||(a.customToolbar={}),b.extend(a.customToolbar,{mbrFonts:"off",mbrFontSize:"off"}));d.hasClass("dropdown-toggle")&&(a.customToolbar=b.extend(a.customToolbar||{},{mbrLink:"off"}));return a});e.regSummernoteButton(p);e.APP.on("openThemeSettings",function(){e.APP.ToogleThemeSettings.target.$elm.find("[data-group-name]").removeClass("selected")});e.APP.on("change.Node.SecondaryComponent",function(a){var d=
a[0],c=a[1];("buttons"==d.target.type||"menu"==d.target.type)&&(d=b(d.originalEvent.target).attr("data-class-var"))&&(a[1]=b("<div/>").append(c).find("a").removeClass(d).end().html())})},summernotePopoverUpdate:function(a,d,c){if(b(d).parent(".dropdown").parent(".nav-dropdown").length&&b(a).hasClass("bottom")){var f=b(a),g=f.height();g=e.APP.appSettings.fullscreenCanvas?parseInt(f.css("top"))-1.2*g:parseInt(f.css("top"))-1.5*g;f.css("top",g)}for(f=0;f<this.registeredSummernoteButtons.length;f++)if(g=
this.registeredSummernoteButtons[f],g.onUpdate){var h=b(a).find('[data-name="'+g.name+'"]');if(h.length)g.onUpdate(d,h,c)}}}})})(jQuery,mbrAppCore);
