var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,a,e){b instanceof String&&(b=String(b));for(var m=b.length,g=0;g<m;g++){var q=b[g];if(a.call(e,q,g,b))return{i:g,v:q}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,e){b!=Array.prototype&&b!=Object.prototype&&(b[a]=e.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,a,e,m){if(a){e=$jscomp.global;b=b.split(".");for(m=0;m<b.length-1;m++){var g=b[m];g in e||(e[g]={});e=e[g]}b=b[b.length-1];m=e[b];a=a(m);a!=m&&null!=a&&$jscomp.defineProperty(e,b,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
$jscomp.checkStringArgs=function(b,a,e){if(null==b)throw new TypeError("The 'this' value for String.prototype."+e+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+e+" must not be a regular expression");return b+""};
$jscomp.polyfill("String.prototype.endsWith",function(b){return b?b:function(a,b){var e=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===b&&(b=e.length);b=Math.max(0,Math.min(b|0,e.length));for(var g=a.length;0<g&&0<b;)if(e[--b]!=a[--g])return!1;return 0>=g}},"es6","es3");$jscomp.arrayIteratorImpl=function(b){var a=0;return function(){return a<b.length?{done:!1,value:b[a++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};
$jscomp.makeIterator=function(b){var a="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];return a?a.call(b):$jscomp.arrayIterator(b)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(b){function a(){this.batch_=null}function e(a){return a instanceof g?a:new g(function(b,e){b(a)})}if(b&&!$jscomp.FORCE_POLYFILL_PROMISE)return b;a.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var m=$jscomp.global.setTimeout;a.prototype.asyncExecuteFunction=function(a){m(a,0)};a.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var e=a[b];a[b]=null;try{e()}catch(w){this.asyncThrow_(w)}}}this.batch_=null};a.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var g=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(v){b.reject(v)}};g.prototype.createResolveAndReject_=function(){function a(a){return function(g){e||(e=!0,a.call(b,g))}}var b=this,e=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};g.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof g)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};g.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(v){this.reject_(v);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};g.prototype.reject_=function(a){this.settle_(2,a)};g.prototype.fulfill_=function(a){this.settle_(1,a)};g.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};g.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)q.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var q=new a;g.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};g.prototype.settleSameAsThenable_=function(a,b){var e=this.createResolveAndReject_();try{a.call(b,e.resolve,e.reject)}catch(w){e.reject(w)}};g.prototype.then=function(a,b){function e(a,b){return"function"==typeof a?function(b){try{m(a(b))}catch(c){r(c)}}:b}var m,r,x=new g(function(a,b){m=a;r=b});this.callWhenSettled_(e(a,m),e(b,r));return x};
g.prototype.catch=function(a){return this.then(void 0,a)};g.prototype.callWhenSettled_=function(a,b){function e(){switch(g.state_){case 1:a(g.result_);break;case 2:b(g.result_);break;default:throw Error("Unexpected state: "+g.state_);}}var g=this;null==this.onSettledCallbacks_?q.asyncExecute(e):this.onSettledCallbacks_.push(e)};g.resolve=e;g.reject=function(a){return new g(function(b,e){e(a)})};g.race=function(a){return new g(function(b,g){for(var m=$jscomp.makeIterator(a),r=m.next();!r.done;r=m.next())e(r.value).callWhenSettled_(b,
g)})};g.all=function(a){var b=$jscomp.makeIterator(a),m=b.next();return m.done?e([]):new g(function(a,g){function r(b){return function(d){u[b]=d;q--;0==q&&a(u)}}var u=[],q=0;do u.push(void 0),q++,e(m.value).callWhenSettled_(r(u.length-1),g),m=b.next();while(!m.done)})};return g},"es6","es3");$jscomp.polyfill("Object.is",function(b){return b?b:function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(b){return b?b:function(a,b){var e=this;e instanceof String&&(e=String(e));var g=e.length;b=b||0;for(0>b&&(b=Math.max(b+g,0));b<g;b++){var q=e[b];if(q===a||Object.is(q,a))return!0}return!1}},"es7","es3");$jscomp.polyfill("String.prototype.includes",function(b){return b?b:function(a,b){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,b||0)}},"es6","es3");
defineM("app-projects",function(b,a,e){function m(d){var c="",f=a.getUserInfo(),h=d.attr("data-theme"),n=d.attr("data-theme-title");f&&f.email&&(c=f.email);f=a.AddonsRegistry.get(h);if(f.get("downloadURL")&&!f.isExpired()){var l=b(a.preloaderHTML).css({opacity:"0.8",transition:"0.2s"}).appendTo(".create-site-modal");a.downloadAddon(f.toJSON()).done(function(){d.attr("data-installed","true");d.find("> div").click()}).fail(function(){a.showError(e("Error add extension")+' "'+n+'"')}).always(function(){l.remove()})}else a.confirmDlg({message:e("The $extension$ theme isn't available for your account").replace("$extension$",
n?"<strong>"+n+"</strong>":"")+(c?" "+c+"<br>":".<br>"),buttons:{cancel:{label:e("Cancel"),className:"btn-default"},confirm:{label:e("Download $theme title$").replace("$theme title$",n),className:"btn-primary"}},callback:function(b){b&&a.openUrl("https://mobirise.com/extensions/kit/")}})}function g(d){var c="",f=a.getUserInfo(),h=d.attr("data-theme"),n=d.attr("data-theme");f&&f.email&&(c=f.email);f=a.AddonsRegistry.get(h);if(f.get("downloadURL")&&!f.isExpired()){var l=b(a.preloaderHTML).css({position:"fixed",
opacity:"0.8",transition:"0.2s"}).appendTo(".presets-site-modal");a.downloadAddon(f.toJSON()).done(function(){d.attr("data-local","true");d.click()}).fail(function(){a.showError(e("Error add extension")+' "'+n+'"')}).always(function(){l.remove()})}else a.confirmDlg({message:e("The $extension$ theme isn't available for your account").replace("$extension$",n?"<strong>"+n+"</strong>":"")+(c?" "+c+"<br>":".<br>"),buttons:{cancel:{label:e("Cancel"),className:"btn-default"},confirm:{label:e("Download $theme title$").replace("$theme title$",
n),className:"btn-primary"}},callback:function(b){b&&a.openUrl("https://mobirise.com/extensions/kit/")}})}function q(d){var c=b('<section id="app-project-sidebar" class="app-layer no-select">\n            <h4 class="app-layer-title">'+e("Site Settings")+'</h4>\n            <span class="app-layer-close mbr-icon-angle-left"></span>\n        </section>');b("body").append(c);b("body").is(".app-sidebar-open")?(a.closeSidebar(),b(".app-sidebar").one("transitionend",function(){x(c,d)})):x(c,d);return c}
function x(a,c){function d(f){0!==b(f.target).parents(".app-layer, .modal").length||b(f.target).is("body, .app-layer, .modal, ul, li")||A(a,d,!0,c)}a.addClass("app-layer-open");b("body").on("click",d);b("button.app-components-toggle").on("click",d);a.find(".app-layer-close").click(function(){A(a,d,!0,c)})}function A(d,c,f,h){var e=b(".app-layer-item-opened");e.length?(e.removeClass("app-layer-item-opened"),e.one("transitionend",function(){d.removeClass("app-layer-open");d.one("transitionend",function(){d.remove();
b(".app-layer-item").remove();f||(a.openSidebar(),a.$projectsListToggle.click())})})):(d.removeClass("app-layer-open"),d.one("transitionend",function(){d.remove();b(".app-layer-item").remove();f||(a.openSidebar(),a.$projectsListToggle.click());a.$projectsListToggle.click()}));v(h);b("body").off("click",c);b("button.app-components-toggle").off("click",c)}function v(d){var c={};b(".app-layer-item").find("input:not(.fakeinput), select").each(function(b,d){d.name&&"checkbox"==d.type?c[d.name]=a.projectSettings[d.name]||
d.checked||!1:d.name&&(c[d.name]=d.value||a.projectSettings[d.name]||!1)});a.changeProjectSettings(d,c)}function w(a){var d=b('<div class="hover-block tooltipstered" data-tab="'+a.name+'" data-tooltipster="right">\n            <span class="hover-block-arrow mbr-icon-angle-right"></span>\n            <h4>'+a.title+'</h4>\n            <span class="hover-block-sub" style="display:none;">Description</span>\n        </div>'),f=b('<section class="app-layer app-layer-item app-layer-'+a.name+' no-select">\n            <h4 class="app-layer-title">'+
a.title+'</h4>\n            <span class="app-layer-close mbr-icon-angle-left"></span>\n            <div class="app-layer-cont">\n                '+a.html+"\n            </div>\n        </section>");b("body").find(".app-layer-"+a.name).length||b("body").append(f);if("common"==a.name)b("#app-project-sidebar").one("transitionend",function(a){d.addClass("open");f.addClass("app-layer-item-opened")});if(b("#app-project-sidebar").find('.hover-block[data-tab="'+a.name+'"]').length){var h=b(".app-layer-"+
a.name).find(".app-layer-cont");h.html(h.html()+a.html)}else b("#app-project-sidebar").find(".app-layer-title").before(d);d.click(function(a){b(".hover-block").removeClass("open");d.addClass("open");a=b(a.currentTarget).attr("data-tab");b("section.app-layer-item").removeClass("app-layer-item-opened");b("section.app-layer-"+a).toggleClass("app-layer-item-opened")});f.find(".app-layer-close").click(function(){f.removeClass("app-layer-item-opened")})}var r={settings:{name:name,currentPage:"index.html",
theme:{name:a.DEFAULT_THEME,title:a.DEFAULT_THEME_TITLE}},pages:{"index.html":{settings:{main:!0,title:"Home",meta_descr:"",header_custom:"",footer_custom:"",html_before:""},components:[]}}},y={},u={},z;a.regExtension({name:"projects",global:{$projectsListToggle:b(".projects-block"),projectPath:void 0,projectSettings:{},$projectName:b(".app-project-name"),getDefaultProject:function(b){var d=this;Bridge.getLocalJSON(a.getAddonDir(a.DEFAULT_THEME)+"/default-project.json",function(c){c=c||{};c.settings=
c.settings||{};c.settings.theme=c.settings.theme||{};c.settings.theme.name=a.DEFAULT_THEME;c.settings.theme.title=a.DEFAULT_THEME_TITLE;c=d.applyFilter("loadRecentProjectDefault",c);console.warn("Used default project");b(c)})},getRecentProject:function(a){function c(c){if(c){var d={path:c.path,name:c.name};c.screenshot&&(d.screenshot=c.screenshot);c=b.extend({},d)||c;var f=c.path+"/project.mobirise";Bridge.paranoicLoadLocal(f,function(d){try{d=JSON.parse(d)}catch(k){console.warn("Project file is wrong "+
f),k.fileName=f,console.error(k),d={}}d?(d.settings=b.extend({},d.settings,c),a(d,c.path)):Bridge.isExistsLocal(c.path,function(b){b?a(0,c.path):(console.warn("Recent(last) project folder is not exists!"),a())})})}else a()}a&&(Bridge.initPath?c({path:Bridge.initPath.replace("/project.mobirise","")}):Bridge.getRecentsList(function(a){(a=a&&a[0])&&a.path?c(a):c()}))},loadRecentProject:function(a){function b(b){a&&a()}var d=this;d.getRecentProject(function(a,c){c?(d.fire("loadRecentProject"),d.loadProject(c,
a,{noSave:!0,onError:function(){d.createProject("My Site",0,0,b)},onDone:function(){d.fire("loadedRecentProject",c);b()}})):d.createProject("My Site",0,0,b)})},loadProject:function(d,c,f){function h(a){k.projectSettings=b.extend({},a.settings);k.projectSettings.versionFirst=k.projectSettings.versionFirst||Bridge.version;k.projectPath=p;k.resetUniqNum(!0);k.applyFilter("loadProjectCore",b.Deferred().resolve(),a,p).then(function(){k.fire("loadProjectCore",a,p);k.Core.loadProject(a).always(function(){k.fire("loadedProject",
a,p);n()})})}function n(){if(f.noSave){var b={path:p,name:k.projectSettings.name};k.projectSettings.screenshot&&(b.screenshot=k.projectSettings.screenshot);a.projectSettings.mbrsite&&(b.mbrsite=a.projectSettings.mbrsite);$Bridge.addRecent(b).then(function(a){return l()})}else a.runSaveProject(function(a){a?l():l(e("Unable to save loaded project"))},!0)}function l(a){a?(console.error(a),f.onError(a)):(f.onSuccess(),f.onDone())}mbrLogger.debug("loadProject:start",{path:d,projectSettings:c.settings},
"project");var k=this;f=f||{};f.onError=f.onError||function(){};f.onSuccess=f.onSuccess||function(){};f.onDone=f.onDone||function(){};if(d.endsWith(".mobirise")){var g=d;var p=d.replace(/\/[^\/]+\.mobirise$/,"")}else g=d+"/project.mobirise",p=d;d=b.Deferred().resolve(c);if(!c){var t=new b.Deferred;Bridge.paranoicLoadLocal(g,function(d){try{d=JSON.parse(d)}catch(B){console.warn("Project file is wrong "+g),B.fileName=g,console.error(B),d="",a.showError(e("Project file error. Try to restore from history"),
function(){a.showHistoryBootbox(a.projectPath)})}d=d||b.extend(!0,{},r);Bridge.getRecentSettings(p,function(a){d.settings=b.extend({},d.settings,a||{path:p});t.resolve(d)})});d=t}d=d.then(function(d){if(!d)return b.Deferred().reject(e("Empty project"));var c=b.Deferred();d.pages?c.resolve(d):a.showError(e("Project file error. Try to restore from history"),function(){c.resolve(d)});return c}).then(0,function(d){k.fire("projectError",p,d);var c=b.Deferred();a.showError(e("Project file error. Try to restore from history")+
" ("+(d&&d.line||0)+")",function(){c.resolve(b.extend(!0,{},r))});return c}).then(function(a){return c=a}).then(function(a){a=k.calcProjectTheme(c);return k.requestTheme(a&&a.name,a&&a.title)}).fail(function(a){return f.onError(a)}).then(function(a){k.fire("loadProject",c,p);return a?(a=k.applyFilter("loadingProject",b.extend(!0,{},c),p),a=k.substProject(a,p),h(a)):$Bridge.addRecent({path:p,name:c.name}).then(function(a){return f.noSave?b.Deferred().resolve():$Bridge.paranoicSaveLocal(g,JSON.stringify(c))}).then(function(a){f.onSuccess();
Bridge.reload()}).fail(function(a){console.error("Unexpected project save error");f.onError(e("Unexpected project save error"))})})},substProject:function(b,c){var d=a.getAddonDir(b.settings&&b.settings.theme&&b.settings.theme.name||a.DEFAULT_THEME),e=JSON.stringify(b);e=e.replace(/@PROJECT_PATH@(\/project\.mobirise)+/g,"@PROJECT_PATH@");c&&(e=e.replace(/@PROJECT_PATH@/g,c),e=e.replace(/\{PROJECT_IMAGES\}/g,c+"/assets/images/"));e=e.replace(/@ADDONS_PATH@/g,a.getAddonsDir());e=e.replace(/@THEME_PATH@/g,
a.path2core(d));try{e=JSON.parse(e)}catch(n){console.error(n),e=b}return e},createProject:function(d,c,f,e){var h=this;d=d||h.projectSettings.name;h.fire("createProject",d);Bridge.initProject(function(l,k){function n(){c=c||b.extend(!0,{},r);c=h.applyFilter("createProject",c,c.settings.name,k.path);h.applyFilter("promiseDefaultProject",Promise.resolve(c),k.path,f).then(function(c){c.settings=b.extend({},c.settings,k);c.settings.theme=b.extend({},c.settings.theme,f);c.settings.name=h.applyFilter("createProjectName",
a.escapeHtml(d));h.loadProject(k.path,c,{onSuccess:function(){h.fire("createdProject",d)},onError:function(b){e&&e(b);a.hidePreloader()},onDone:function(){e&&e();a.hidePreloader()}})})}!l&&k&&k.path?c||f?n():h.getDefaultProject(function(a){c=a;n()}):(console.error("Error init project folder"),e&&e(l))})},saveProjectFiles:function(a,b,e){var c=this;try{var d=c.prepareProjectText()}catch(l){console.error(l)}d?Bridge.paranoicSaveLocal(a+"/project.mobirise",d,function(d,f){b&&d?c.makeScreenshot(function(b){b?
Bridge.copyLocal(b,a+"/screenshot.png",function(b){b||console.error("Error copy screenshot to "+a+"/screenshot.png");e(a,b&&"screenshot.png")}):e(a)}):e(d&&a)}):(console.error("Wrong project compilation"),e(!1))},waiting:0,running:0,runSaveProject:function(b,c){function d(){a.waiting&&(a.waiting.timeout&&clearTimeout(a.waiting.timeout),a.waiting.timeout=setTimeout(function(){if(a.running)setTimeout(d,1);else if(a.running=a.waiting,a.waiting=0,a.projectPath){var b=setTimeout(function(){b=0;console.error("Error: SaveProject timeout expired. Next run will be forced.");
e(!1);a.waiting&&d()},4E3);a._saveProject(function(c){b&&(clearTimeout(b),e(c));a.waiting&&d()},!a.running.screenshot)}else console.error("Critical error: projectPath is unexpectedly empty, while saveProject"),e(!1)},a.waiting.callbacks.length?100:1E3))}function e(b){var c=a.running.callbacks;if(c){for(var d=0;d<c.length;d++)if(c[d])try{c[d](b)}catch(C){console.error("SaveProject callback error: "+C.message,C)}a.running=0}}a.projectPath?(a.waiting=a.waiting||{timeout:0,callbacks:[],screenshot:!1},
a.waiting.screenshot=a.waiting.screenshot||!c,b&&a.waiting.callbacks.push(b),a.running||d()):(console.warn("projectPath is unexpectly empty, while saveProject"),b&&b(!1))},_saveProject:function(b,c){var d=this,h=d.projectSettings.name,n=d.projectPath;b=b||function(){};d.fire("saveProject",h,n);d.saveProjectFiles(n,!c,function(f,k){f?(f={name:h,path:n},!c&&k?f.screenshot=k:d.projectSettings.screenshot&&(f.screenshot=d.projectSettings.screenshot),a.projectSettings.mbrsite&&(f.mbrsite=a.projectSettings.mbrsite),
Bridge.addRecent(f,function(c){c||a.showError(e("Error update recents list."));b(!0);d.fire("savedProject",h,n)})):(console.error("Error to save project to "+n),a.criticalError(e("Error to save project file. Close application and run again."),"project_not_save"),b(!1))})},IMAGES_FOLDER:"assets/images",getProjectImagesDir:function(){return this.projectPath+"/"+this.IMAGES_FOLDER},addImageToAssets:function(d,c){var e=b.Deferred();d&&c?Bridge.transformImage(d,c,function(b){Bridge.saveFileUnique(b,a.getProjectImagesDir(),
function(a){e.resolve(a)})}):d&&0!==d.indexOf(a.getAddonDir(a.theme.name))&&0!==d.indexOf(Bridge.base)&&0!==d.indexOf("web/")?0===d.indexOf(Bridge.path2app(a.getAddonDir(a.theme.name)))?e.resolve("web/"+d):Bridge.saveFileUnique(d,this.getProjectImagesDir(),e.resolve):e.resolve(d);return e.promise()},addImageFromUrlToAssets:function(a){function b(a){a?Bridge.saveFileUnique(a,d.getProjectImagesDir(),e.resolve):e.resolve(!1)}var d=this,e=jQuery.Deferred();Bridge.download2(a,function(a){if(a){var d=Bridge.splitPath(a);
if("jpg"==d.ext)b(a);else{var c=d.dir+d.name+".jpg";Bridge.moveLocal(a,c,function(a){return b(a&&c)})}}else b(!1)});return e.promise()},importProject:function(b,c){function d(b){h.runSaveProject(function(d){d||console.error("Error: unable to save current project");h.loadProject(b,0,{onError:function(b){a.showError("Error while import project: "+b);c&&c()},onSuccess:function(){h.fire("importedProject",b)},onDone:function(){h.showProjectsList();c&&c();a.closeSidebar()}})},!0)}var h=this;h.fire("importProject");
b?d(b):Bridge.runFileDialog(e("Open Mobirise Site"),"","Mobirise (*.mobirise)",function(a){a&&d(a.replace(/\/project.mobirise$/,""))})},removeProject:function(a,c){var d=this;a=a.substring(0,a.lastIndexOf("/"));d.applyFilter("removeProject",b.Deferred().resolve(),a).then(function(){d.fire("removeProject",a);Bridge.rmRecent(a,function(b){b?(d.fire("removedProject",a),c&&c(!0)):c(!1)})})},changeProjectSettings:function(d,c){d=d.substring(0,d.lastIndexOf("/"));this.fire("changeProjectSettings",d,c);
c=this.applyFilter("changeProjectSettings",c,d);this.projectSettings=b.extend({},this.projectSettings,c);var e={path:a.projectSettings.path,name:a.projectSettings.name};a.projectSettings.screenshot&&(e.screenshot=a.projectSettings.screenshot);a.projectSettings.mbrsite&&(e.mbrsite=a.projectSettings.mbrsite);Bridge.changeRecentSettings(d,e,function(b){a.fire("changedProjectSettings",d,c)})},showProjectsList:function(){if(!a.$body.hasClass("app-projects-list-open")){var d=this;Bridge.getRecentsList(function(c){d.fire("showProjectsList");
var f='<div class="col-xs-12">\n                            <div class="app-new-project project-element-panel">\n                                <div class="project-img">\n                                    <i class="mbr-icon-plus"></i>\n                                    <h3 class="project-name">'+e("Create New Site")+'</h3>\n                                </div>\n                                <div class="project-body app-import-project" data-tooltipster="bottom" title="'+e("Open Mobirise site (project.mobirise) not listed here.")+
'">\n                                    <span class="app-import-project-or">'+e("or")+'</span>\n                                    <span class="app-import-project-label">'+e("Import Mobirise Site")+"</span>\n                                </div>\n                            </div>\n                        </div>";f=a.applyFilter("showProjectsListStart",f);for(var h in c){var g=c[h].path;if(g){var l=g+"/project.mobirise",k=c[h].name||decodeURI(g.replace(/^.*[\\\/]/,"")),m=c[h].screenshot?g+"/"+
c[h].screenshot+"?nocache="+ +new Date:"",p=d.projectPath===g,t=a.hasThemeSettings(a.theme.params);f+=d.applyFilter("showProjectsListEach",'<div class="project-element col-xs-12" data-url="'+l+'" data-path="'+Bridge.url2sys(l)+'" data-name="'+a.escapeHtml(k)+'">\n                                <div class="project-element-panel '+(p?"active":"")+'">\n                                    <div class="project-img '+(m?"":"project-img-icon")+'">\n                                        '+(m?'<div style="background-image: url('+
m+')"></div>':'<i class="mbr-icon-image"></i>')+'\n                                    </div>\n                                    <div class="project-body">\n                                        <h3 class="project-label project-name text-primary">'+a.escapeHtml(k)+'</h3>\n                                    </div>\n                                    <div class="btn-group">\n                                        <span class="app-project-clone btn btn-primary" data-tooltipster="bottom" title="'+
e("Clone Site")+'">\n                                            <i class="mbr-icon-copy"></i>\n                                        </span>\n                                        '+(p&&t?'<span class="app-project-styles btn btn-info" data-tooltipster="bottom" title="'+e("Edit Site Styles")+'">\n                                            <i class="mbr-icon-paint-brush"></i>\n                                        </span>':"")+"\n                                        "+(p?'<span class="app-project-settings btn btn-info" data-tooltipster="bottom" title="'+
e("Site Settings")+'">\n                                            <i class="mbr-icon-cog"></i>\n                                        </span>':"")+'\n                                        <span class="app-project-remove btn btn-material-red" data-tooltipster="bottom" title=" '+e("Remove Site")+'">\n                                            <i class="mbr-icon-trash"></i>\n                                        </span>\n                                    </div>\n                                </div>\n                            </div>',
g,c[h])}}f=a.applyFilter("showProjectsList",f);d.fire("showSideBarsSection");a.showDialog({title:e("Sites"),className:"show-site-list-modal",body:'<div class="row form-group">\n                                <div class="col-xs-4">\n                                    <input class="search-site-input form-control" type="text" placeholder="'+e("Search")+'" value="">\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-12">\n                                    <div class="site-list">\n                                        '+
f+"\n                                    </div>\n                                </div>\n                            </div>",show:function(c){var e,f=a.stopIfRepeatDecorator(function(a){e||(e=c.find(".project-element"));var d=a.target.value.toLowerCase();e.each(function(a,c){a=b(c);c=a.find(".project-name").text().toLowerCase();var e=a.find(".project-domain").text().toLowerCase();c.includes(d)||e.includes(d)?a.removeClass("hidden"):a.addClass("hidden")})},100);c.find(".search-site-input").on("input",
function(a){return f(a)});c.find(".site-list").on("click",".project-element > .project-element-panel:not(.active)",function(a){if(!b(a.target).hasClass(".btn")&&!b(a.target).closest(".btn").length){a.preventDefault();a.stopPropagation();a=b(this).parent().attr("data-url");var c=b(this).parent().attr("data-path")||a,e=b(this).find(".project-name").text();d.openProjectFromList(a,c,e)}});c.on("click",".app-project-clone",function(a){a.preventDefault();a.stopPropagation();a=b(this).closest("[data-url]").attr("data-url").replace("/project.mobirise",
"");var c=b(this).closest("[data-name]").attr("data-name")+"-clone";d.projectClone(a,c)});c.on("click",".app-project-styles",function(a){d.closeSidebar();d.openThemeSettings()});c.on("click",".app-project-settings",function(a){a.preventDefault();a=b(this).parents("[data-url]:eq(0)").attr("data-url")||"";d.openProjectSettings(a)});c.on("click",".app-project-remove",function(a){a.preventDefault();a.stopPropagation();var c=b(this),e=c.parents("[data-url]:eq(0)").attr("data-url"),f=c.parents("[data-path]:eq(0)").attr("data-path")||
e;f=c.parents("[data-name]:eq(0)").attr("data-name")||f;c.tooltip("destroy");d.projectRemove(e,f,a)});c.on("click",".app-new-project",function(a){a.preventDefault();d.newProject()});c.on("click",".app-import-project",function(a){a.preventDefault();a.stopPropagation();d.importProject()});c.on("click",".modal-header .close",function(){a.hideProjectsList()});d.$body.addClass("app-sidebar-open app-projects-list-open");d.fire("showedProjectsList",c)}})})}},hideProjectsList:function(){this.$body.hasClass("app-projects-list-open")&&
(this.fire("hideProjectsList"),this.$body.removeClass("app-projects-list-open").find(".show-site-list-modal").modal("hide"),this.fire("hiddenProjectsList"))},makeScreenshot:function(d){var c=this;c.fire("makeScreenshot");var e=c.appElements.iframe.width,h=c.appElements.iframe.height,g=(c.appElements.window.width-e)/2,l=c.appElements.window.height-h,k=Math.min(e,800),m=k*h/e,p=b("body > *:not(.app-navbar, .app-template, script, link)");p.addClass("hidden-interface");a.Core.$body.is(".rounded-canvas")||
a.Core.$body.css("padding","0");a.Core.$template.find(".app-component > .app-component-menu").css("display","none");var t=new Date;t=Bridge.tempLocation+"/screen"+t.getFullYear()+t.getMonth()+t.getDay()+"_"+t.getHours()+t.getMinutes()+t.getSeconds()+".jpg";Bridge.getScreen(function(b){p.removeClass("hidden-interface");a.Core.$body.css("padding","");a.Core.$template.find(".app-component > .app-component-menu").css("display","");d&&d(b);c.fire("makedScreenshot",b)},t,[k,m],[g,l,e,h])},showPresets:function(d,
c){return new Promise(function(f,h){function n(b){var c=b.presetsList,d=[];if(b.local){var e=a.getAddonDir(b.themeName);var f=Bridge.path2app(e)}else f="https://my.mobirise.com/data/upload/thumbs/"+b.themeName;for(var h in c)c.hasOwnProperty(h)&&d.push(function(c,d){return'<div class="column column-preset col-sm-4 col-md-4 col-lg-3" data-local=\''+b.local+"' data-theme='"+b.themeName+"' data-theme-title='"+b.themeTitle+"' namepreset=\""+c+'" data-titlepreset="'+d.title+'">\n                                                <div class="column-content">\n                                                    <div class="wrapper-img">\n                                                        <div class="theme-type-tag">'+
b.themeTitle+'</div>\n                                                        <img data-src="'+f+"/projects/"+c+'/cover.jpg" src="'+a.core2abs("../builder/images/imageplaceholder.jpg")+'">\n                                                    </div>\n                                                    <div class="wrapper-name">\n                                                        <span>'+d.title+"</span>\n                                                    </div>\n                                                </div>\n                                            </div>"}(h,
c[h]));return d}(function(d){d=d.map(function(a){if(a)return n(a).join("")});d.unshift('\n                            <div class="column column-preset col-sm-4 col-md-4 col-lg-3" data-local="true" data-theme-title="'+a.DEFAULT_THEME_TITLE+'" data-titlePreset="'+a.DEFAULT_THEME_TITLE+'">\n                                <div class="column-content">\n                                    <div class="wrapper-icon" style="width: 100%;height: 90%;display: flex;justify-content: center;align-items: center;">\n                                        <i class="mbr-icon-file" style="font-size: 10rem;color: #777d74;"></i>\n                                    </div>\n                                    <div class="wrapper-name">\n                                        <span>'+
e("Add Blank Page")+"</span>\n                                    </div>\n                                </div>\n                            </div>\n                        ");d='<div class="site-create-presets-list main-wrapper">\n                                        <div class="columns row">\n                                            <div class="columns-presets">\n                                                '+d.join("\n")+"\n                                            </div>\n                                        </div>\n                                </div>";
b("#presets").append(d);b(".column-preset").each(function(a,c){b(c).on("click",function(){if("false"===b(c).attr("data-local")){var a=b(c);g(a)}else a={},a.title=b(c).attr("data-theme-title"),a.name=b(c).attr("data-theme"),a.titlePreset=b(c).attr("data-titlepreset"),a.nameSelectPreset=b(c).attr("namepreset"),a.presetSourceTheme=b(c).attr("data-theme"),f(a)})});b(d).find(".column-options").on("click",".column-option",function(){b(this).hasClass("plus")?(presets.modal("hide"),f(void 0)):b(this).hasClass("features")&&
(a.showAddonsList(),presets.modal("hide"),h())});var k=b(d).find(".columns-presets > .column-preset"),l=a.stopIfRepeatDecorator(function(a){var c=a.target.value.toLowerCase();k.each(function(a,d){a=b(d);a.attr("data-titlepreset").toLowerCase().includes(c)?a.removeClass("hidden"):a.addClass("hidden")})},100);b(d).find(".search-preset-input").on("input",function(a){l(a)});c()})(d)})},replaceVisibleDataSrc:function(a){b(a).each(function(a,d){if(a=b(d).attr("data-src")){a=d.getBoundingClientRect();var c=
document.documentElement.clientHeight,e=a.bottom<c&&0<a.bottom;a=0<a.top&&a.top<c||e}a&&(b(d).attr("src",b(d).attr("data-src")),b(d).removeAttr("data-src"))})},newProject:function(){var d=this;if(!z){z=!0;var c=a.showDialog({title:e("Create New Site"),className:"create-site-modal presets-site-project modal-fs",body:['<div class="row">\n<div class="col-md-12">\n<form class="project-create-form">\n<div class="form-group row clearfix">','<label class="col-md-3 control-label" for="site-create-name">'+
e("Site Name")+"</label>",'<div class="col-md-9">','<input id="site-create-name" name="name" type="text" placeholder="'+e("Type the name of your new site")+'" value="Site '+Bridge.dateFormat(new Date,"yyyy-MM-dd hh:mm")+'" class="form-control">','</div>\n</div>\n<div class="form-group row clearfix">\n<div class="col-md-8">\n<ul class="nav nav-tabs" style="margin-top:2px" role="tablist">','<li role="presentation" class="active"><a href="#presets" aria-controls="presets" role="tab" data-toggle="tab">'+
e("Page Templates")+"</a></li>",'<li role="presentation"><a href="#theme" aria-controls="theme" role="tab" data-toggle="tab">'+e("Themes")+"</a></li>",'</ul>\n</div>\n<div class="col-md-4">','<input id="filter-themes" style="height:100%;" name="name" type="text" placeholder="'+e("Search")+'" value="" class="form-control">','</div>\n</div>\n<div class="form-group row clearfix">\n\x3c!-- Tab panes --\x3e\n<div class="col-md-12 tab-content">\n<div role="tabpanel" class="tab-pane active" id="presets">\n<div class="site-create__preloader-wrapper">',
e("No templates matched your search"),'</div>\n</div>\n<div role="tabpanel" class="tab-pane" id="theme">\n<div class="site-create-themes-list">\n<div class="site-create__preloader-wrapper">',e("No themes matched your search"),"</div>\n</div>\n</div>\n</div>\n</div>\n</form>\n</div>\n</div>"].join("\n")});b(c).on("shown.bs.modal",function(){b(".site-create__preloader-wrapper").hide();a.showPreloader();var f="";d.getAddonsEx(function(h){var g=h.reduce(function(a,b){"archive"===b.status&&a.push(b.name);
return a},[]),l=h.filter(function(a){return!g.includes(a.name)});l.map(function(a){u[a.name]=a;if(a.description){var b=document.createElement("div");b.innerHTML=a.description;Array.prototype.slice.call(b.getElementsByTagName("a")).forEach(function(a){return a.remove()});u[a.name].description=b.innerHTML}else u[a.name].description=""});h=h.filter(function(a){return!l.some(function(b){return b.name===a.name})&&"archive"!==a.status&&"teaser-48"!==a.name});l=l.filter(function(a){return"teaser-48"!=a.name});
l=l.concat(h);Promise.resolve().then(function(a){return new Promise(function(a,b){fetch("https://my.mobirise.com/data/upload/thumbs/projects.json").then(function(b){if(404===b.status)throw Error("Error while fetch projects.json");b.json().then(function(b){a(b)}).catch(function(b){console.error("Error while parsing projects.json");a(null)})}).catch(function(b){console.error("Error while fetch projects.json");a(null)})})}).then(function(b){return Promise.all(l.map(function(c){return new Promise(function(d){if(c.installed&&
c.paid&&!c.expired||c.name===a.DEFAULT_THEME){var e=a.getAddonDir(c.name)+"/projects/list.json";Bridge.getLocalJSON(e,function(a){a?d({themeName:c.name,themeTitle:c.title,presetsList:a,local:!0}):d(null)})}else a.isBuildInAddon(c.name)?(e=a.getAddonDir(c.name)+"/projects/list.json",Bridge.getLocalJSON(e,function(a){a?d({themeName:c.name,themeTitle:c.title,presetsList:a,local:!0}):d(null)})):y[c.name]?d({themeName:c.name,themeTitle:c.title,presetsList:y[c.name],local:!1}):Promise.resolve().then(function(){b&&
b[c.name]?(y[c.name]=b[c.name],d({themeName:c.name,themeTitle:c.title,presetsList:b[c.name],local:!1})):fetch("https://my.mobirise.com/data/upload/thumbs/"+c.name+"/projects/list.json").then(function(a){404===a.status?(console.log("No presets in "+c.name+" theme."),d(null)):a.json().then(function(a){y[c.name]=a;d({themeName:c.name,themeTitle:c.title,presetsList:a,local:!1})}).catch(function(a){d(null)})},function(a){console.log(a.message);d(null)})})})}))}).then(function(d){a.hidePreloader();return a.showPresets(d.reduce(function(b,
c){if(!c)return b;if(c.themeName===a.DEFAULT_THEME||"startm5"===c.themeName)return b.unshift(c),b;b.push(c);return b},[]),function(){b(c).modal("handleUpdate");b(c).trigger("scroll")})}).then(function(f){$Bridge.getSettings("dontShowCreateSiteModal").then(function(h){function g(){a.closeSidebar();c.modal("hide");d.runSaveProject(function(c){c||console.error("Error: unable to save current project");c=b(".project-create-form #site-create-name").val();d.createProject(c,0,f,function(b){b&&a.showError(e("Unexpected project create error ")+
" ("+b+").",function(){d.showProjectsList()})})},!0)}if("true"!==h){h=b(".project-create-form #site-create-name").val();var k=a.showDialog({body:['<div class="form-group">',e("Do you want to create the $site name$ site based on the $theme name$ theme, $name preset$ Template?").replace("$site name$","<strong>"+h+"</strong>").replace(f.titlePreset?"$name preset$":", $name preset$ Template",f.titlePreset?"<strong>"+f.titlePreset+"</strong>":"").replace("$theme name$","<strong>"+f.title+"</strong>"),
'</div>\n<div class="dont-show-more clearfix">\n   <div class="togglebutton">\n       <label style="width: 100%;">\n           <input type="checkbox" id="dont-show-again">\n           <span class="toggle" style="margin-top: -6px;"></span>',e("Don't show again"),"       </label>\n   </div>\n</div>"].join("\n"),buttons:{cancel:{label:e("Cancel"),className:"btn-default",callback:function(){c.modal("hide");a.closeSidebar()}},success:{label:e("Ok"),className:"btn-primary",callback:function(){var a=k.find("#dont-show-again")[0].checked;
$Bridge.setSettings("dontShowCreateSiteModal",a);g()}}}}).on("hidden.bs.modal",function(){a.hidePreloader()})}else g()})});h=l.find(function(a){return"startm5"===a.name});var k=l.find(function(a){return"mobirise5"===a.name});l.splice(l.indexOf(h),1);l.splice(l.indexOf(k),1);l.unshift(k);l.unshift(h);for(h=0;h<l.length;h++)k="",k+='<div class="col-xs-6 col-sm-6 col-md-4 col-lg-3" data-theme="'+l[h].name+'" data-installed="'+!!l[h].installed+'" data-theme-title="'+l[h].title+'"><div>',k+='<div class="card-img"><img data-src="'+
(l[h].largeCover||l[h].cover)+'" src="'+a.core2abs("../builder/images/imageplaceholder.jpg")+'"></div>',k+="<span>"+l[h].title+"</span>",k+="</div></div>",f+=k;f=a.applyFilter("themes_list",f);b(c).find(".site-create-themes-list").append(f);var q=b(c).find(".site-create-themes-list img"),p=b(c).find(".site-create-presets-list img");b(c).on("scroll",a.throttle(function(){var a=b(c).find('li[role="presentation"].active a').attr("aria-controls");"theme"===a&&d.replaceVisibleDataSrc(q);"presets"===a&&
(b(p).length||(p=b(c).find(".site-create-presets-list img")),d.replaceVisibleDataSrc(p))},500));c.on("hidden.bs.modal",function(){z=!1}).on("shown.bs.modal",function(a){b(a.target).find("#site-create-name").focus()});b(c).find('a[data-toggle="tab"]').on("shown.bs.tab",function(){b(c).modal("handleUpdate");b(c).trigger("scroll")});b(".project-create-form .site-create-themes-list > :not(.ext-link) > div").click(function(){if("false"===b(this).parent().attr("data-installed")){var f=b(this).parent();
m(f)}else{f=b(this).parent();var h=b(".project-create-form #site-create-name").val();f={name:f.attr("data-theme"),title:f.attr("data-theme-title")};a.applyFilter("promiseChosenTheme",Promise.resolve(f)).then(function(f){a.showPreloader();setTimeout(function(){b(".preloader").css("opacity",1)},1);$Bridge.getSettings("dontShowCreateSiteModal").then(function(b){function g(){a.closeSidebar();c.modal("hide");d.runSaveProject(function(b){b||console.error("Error: unable to save current project");d.createProject(h,
0,f,function(b){b&&a.showError(e("Unexpected project create error ")+" ("+b+").",function(){d.showProjectsList()})})},!0)}if("true"!==b)var k=a.showDialog({body:['<div class="form-group">',e("Do you want to create the $site name$ site based on the $theme name$ theme, $name preset$ Template?").replace("$site name$","<strong>"+h+"</strong>").replace(f.titlePreset?"$name preset$":", $name preset$ Template",f.titlePreset?"<strong>"+f.titlePreset+"</strong>":"").replace("$theme name$","<strong>"+f.title+
"</strong>"),'</div>\n<div class="dont-show-more clearfix">\n   <div class="togglebutton">\n       <label style="width: 100%;">\n           <input type="checkbox" id="dont-show-again">\n           <span class="toggle" style="margin-top: -6px;"></span>',e("Don't show again"),"       </label>\n   </div>\n</div>"].join("\n"),buttons:{cancel:{label:e("Cancel"),className:"btn-default"},success:{label:e("Ok"),className:"btn-primary",callback:function(){var a=k.find("#dont-show-again")[0].checked;$Bridge.setSettings("dontShowCreateSiteModal",
a);g()}}}}).on("hidden.bs.modal",function(){a.hidePreloader()});else g()})}).catch(function(){a.closeSidebar();a.hidePreloader();c.modal("hide")})}})},{type:"theme"},{server:!0,serverOptions:{with_archive:1}})})}},openProjectSettings:function(d){if(d){this.fire("showProjectSettings",d,this.projectSettings.name);var c=this.theme&&this.theme.params?this.theme.params.title:"Mobirise",f=q(d);c=[{title:e("Common"),name:"common",html:'<div class="form-group col-md-12">\n                        <label class="control-label">'+
e("Theme Name")+"</label>\n                        <p>"+c+'</p>\n                    </div>\n                    <div class="form-group col-md-12 site-name-setting-wrap">\n                        <label class="control-label" for="site-settings-name">'+e("Site Name")+'</label>\n                        <input id="site-settings-name" name="name" type="text" placeholder="'+e("Site Name")+'" value="'+a.projectSettings.name+'" class="form-control">\n                    </div>\n                    <div class="form-group col-md-12">\n                        <label class="control-label">'+
e("Project Files")+'</label>\n                        <div class="form-row">\n                            <div class="col">\n                                <a href="javascript:void(0)" class="app-export-project btn btn-primary w-100" data-tooltipster="bottom" title="'+e("Create a project copy in a different location. Use Publish to create a full copy of the site")+' (project + HTML files).">'+e("Export Project")+"</a>\n                            </div>\n                        </div>\n                    </div>"}];
c=a.applyFilter("sidebarProjectSettings",c);b(c).each(function(a,b){w(b)});f.one("transitionend",function(b){a.fire("shownSidebarProjectSettings",b,d)});this.fire("showedProjectSettings",d,name)}},projectRemove:function(d,c,f){var h=this;c=b(f.target).closest(".project-element").find(".project-domain").length?e("Do you want to remove a local copy of $site name$?").replace("$site name$","<strong>"+a.escapeHtml(c)+"</strong>"):e("Do you want to remove $site name$?").replace("$site name$","<strong>"+
a.escapeHtml(c)+"</strong>");a.confirmDlg(c,function(b){b?h.removeProject(d,function(b){0===d.indexOf(h.projectPath)?h.loadRecentProject(function(){a.closeSidebar()}):a.$body.find('.show-site-list-modal .project-element[data-url="'+d+'"]').remove()}):h.fire("cancelProjectRemove",d,f)})},projectClone:function(d,c){a.showPreloader();setTimeout(function(){b(".preloader").css("opacity",1)},1);Bridge.initProject(function(f,h){var g=h&&h.path;f?a.showError(e("Unable to init project")):a.runSaveProject(function(f){f||
console.error("Error: unable to save current project");Bridge.copyLocal(d,g,function(d){if(d){var f=d+"/project.mobirise";Bridge.getLocalJSON(f,function(g){g?(g.settings=b.extend({},g.settings,h),g.settings.name=c,Bridge.saveLocalFile(f,JSON.stringify(g),function(){a.importProject(d,function(){a.closeSidebar();a.hidePreloader()})})):a.showError(e("Cloned project is wrong"))})}else a.showError(e("Unable to clone project")),a.hidePreloader()})},!0)})},openProjectFromList:function(d,c,f){d&&$Bridge.isExistsLocal(d.replace(/project\.mobirise$/,
""),function(h){if(h)a.showPreloader(),setTimeout(function(){b(".preloader").css("opacity",1)},1),$Bridge.getSettings("dontShowOpenSiteModal").then(function(b){function h(){a.runSaveProject(function(b){b||(a.hidePreloader(),console.error("Error: unable to save current project"));a.loadProject(d,0,{noSave:!0,onError:function(b){a.hidePreloader();a.alertDlg(b)},onDone:function(){a.closeSidebar();a.hidePreloader()}})},!0)}if("true"!==b)var g=a.showDialog({body:['<div class="form-group">',e("Do you want to close the current site and open $site name$?").replace("$site name$",
"<strong>"+a.escapeHtml(f||c)+"</strong>"),'</div>\n<div class="dont-show-more clearfix">\n   <div class="togglebutton">\n       <label style="width: 100%;">\n           <input type="checkbox" id="dont-show-again">\n           <span class="toggle" style="margin-top: -6px;"></span>',e("Don't show again"),"       </label>\n   </div>\n</div>"].join("\n"),buttons:{cancel:{label:e("Cancel"),className:"btn-default"},success:{label:e("Ok"),className:"btn-primary",callback:function(){var a=g.find("#dont-show-again")[0].checked;
$Bridge.setSettings("dontShowOpenSiteModal",a);h()}}}}).on("hidden.bs.modal",function(){a.hidePreloader()});else h()});else{var g=a.confirmDlg('<a href="javascript:void(0)" data-tooltipster="bottom" title="'+c+'">'+e("%This site% is not available. Do you want to remove it from the list?").replace(/%(.+)%/,"<strong>"+(f||"$1")+"</strong></a>"),function(b){g.find("[data-tooltipster]").tooltipster("destroy");b&&a.removeProject(d,function(b){0===d.indexOf(a.projectPath)?a.loadRecentProject(function(){a.closeSidebar()}):
a.$body.find('.show-site-list-modal .project-element[data-url="'+d+'"]').remove()})});g.find("[data-tooltipster]").tooltipster({delay:0,position:"bottom"})}})},addProjectAsset:function(b,c,e){b=b.replace(/\.\.\//g,"");$Bridge.saveLocalFile(a.projectPath+"/assets/"+b,c,e)},readProjectAsset:function(b,c){b=b.replace(/\.\.\//g,"");$Bridge.loadLocalFile(a.projectPath+"/assets/"+b).then(function(a){c(a)})},getPages:function(){return a.Core.getResultProject().pages},getResultHTML:function(b){return a.Core.getResultHTML(b)}},
events:{load:function(){a.$projectsListToggle.on("click",function(b){b.preventDefault();b.stopPropagation();a.showProjectsList()});a.on("clickBody",function(){a.hideProjectsList()});a.on("sidebarClosed",function(){a.hideProjectsList()});a.$body.on("submit",".project-create-form",function(a){a.stopPropagation();a.preventDefault();b(a.target).closest(".modal-content").find(".btn-primary").click()});a.$body.on("click",".app-export-project",function(b){b.preventDefault();b.stopPropagation();Bridge.runFileDialog("Browse for folder",
"","dir",function(b){b&&a.exportProject(b)})});a.$body.on("submit",".page-settings-form",function(a){a.preventDefault();b(a.target).closest(".modal-dialog").find('[data-bb-handler="success"]').click()});var d;Bridge.regQuitTask(function(b){d=1;a.$template.find("[contenteditable]:focus").trigger("blur");a.runSaveProject(b,!0)});Bridge.bind("pause",function(){a.runSaveProject(function(a){a?console.log("Project saved on pause."):console.error("Error: unable to save current project")})});a.on(["changedProjectSettings",
"saveMediaImageDialog","saveMediaVideoDialog","savedSiteCodeEditor"],function(){d||a.runSaveProject(!1,!0)});a.Core.on("removedPage",function(){d||a.runSaveProject()});a.Core.on("addedComponent removedComponent changedComponentPosition changedComponentParams addedPage changedPageSettings convertedComponentToCustomHTML renderedCodeEditorChanges rivetsBlur saveMediaIconFontDialog".split(" "),function(){d||a.runSaveProject(!1,!0)});a.$body.on("keyup",".project-create-form #filter-themes",function(){var a=
document.querySelector(".site-create-themes-list").children,d=document.querySelector(".site-create-presets-list .columns-presets").children,e=this.value.toLowerCase();a.forEach=[].forEach;a.forEach(function(a){return a.classList.remove("hide")});d.forEach=[].forEach;d.forEach(function(a){return a.classList.remove("hide")});if(""!==e){e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var g=b(a).filter(function(a){return this.dataset.themeTitle});a=b(a).filter(function(a){return!this||!this.dataset.themeTitle||
~this.dataset.themeTitle.toLowerCase().search(e)||u[this.dataset.theme]&&~u[this.dataset.theme].description.toLowerCase().search(e)?!1:!0});var l=b(d).filter(function(a){return!this||!this.dataset.themeTitle||!this.dataset.titlepreset||~this.dataset.titlepreset.toLowerCase().search(e)||u[this.dataset.theme]&&~u[this.dataset.theme].description.toLowerCase().search(e)?!1:!0});a.forEach=[].forEach;a.forEach(function(a){return a.classList.add("hide")});g.length-a.length?b("#theme .site-create__preloader-wrapper").hide():
b("#theme .site-create__preloader-wrapper").show();l.forEach=[].forEach;l.forEach(function(a){return a.classList.add("hide")});d.length-l.length?b("#presets .site-create__preloader-wrapper").hide():b("#presets .site-create__preloader-wrapper").show();b(".site-create-themes-list").trigger("scroll")}});a.$body.on("blur",".project-create-form #filter-themes",function(b){a.fire("inputBlur",b.target)});a.$body.find(".navbar-project-info .app-project-name").on("click",function(c){c.preventDefault();c.stopPropagation();
a.openProjectSettings(a.projectPath+"/project.mobirise");setTimeout(function(){b('#app-project-sidebar > [data-tab="common"]').click();b(c.target).hasClass("navbar-domain")?b(".app-layer-common .mbrsite-domain-control").addClass("selected"):b(".app-layer-common .site-name-setting-wrap").addClass("selected")},100)})},loaded:function(){a.runSaveProject()},showSideBarsSection:function(){this.hideProjectsList()},incomingFile:function(b){/project.mobirise$/.test(b)&&a.importProject(b.replace(/\/project.mobirise$/,
""))}}})},["jQuery","mbrApp","TR()"]);
