defineM("mbrApp",function(g,f){var e=function(){this.$iframeOverlay=g("<div>").hide().css({position:"absolute",left:0,top:65,right:0,bottom:0}).appendTo("body");f.isMobile&&g("html").addClass("device");this.$window=g(window);this.$body=g("body")},d={},l={};e.prototype.on=function(a,b){if(g.isArray(a))for(var c in a)this.on(a[c],b);else if(a in l){if(b)try{b.apply(this,l[a])}catch(h){console.error(h)}}else(d[a]||(d[a]=[])).push(b)};e.prototype.off=function(a,b){if(!d[a])return!1;if(b)for(var c=0;c<
d[a].length;c++)d[a][c]===b&&(d[a][c]=void 0);else delete d[a]};e.prototype.fire=function(a){f&&f.debug&1&&console.log("fire mbrApp::"+a);var b=[].slice.call(arguments,1);if("undefined"!==typeof d[a])for(var c in d[a])if(d[a][c])try{d[a][c].apply(this,b)}catch(h){console.error(h)}};e.prototype.fireOnce=function(a){f&&f.debug&1&&console.log("fire mbrApp::"+a);if(!(a in l)){var b=[].slice.call(arguments,1);l[a]=b;for(var c in d[a])if(d[a][c])try{d[a][c].apply(this,b),d[a][c]=void 0}catch(h){console.error(h)}}};
var m={};e.prototype.addFilter=function(a,b){(m[a]||(m[a]=[])).push(b)};e.prototype.applyFilter=function(a){f&&f.debug&2&&console.log("applyFilter App:"+a);var b=[].slice.call(arguments,1);if(m[a])for(var c=m[a],d=0,e=c.length;d<e;d++)try{b[0]=c[d].apply(this,b),"undefined"==typeof b[0]&&console.warn("handle of "+a+" filter return undefined: ",c[d])}catch(p){console.error(p)}return b[0]};var k={};e.prototype.regExtension=e.prototype.registerExtension=function(a){if(!a.name||"undefined"!==typeof k[a.name])return!1;
k[a.name]=a;if(a.global)for(var b in a.global)b in this?console.error("Error re-definition method mbrApp."+b+" by module "+a.name):this[b]=a.global[b];if(a.events)for(var c in a.events)this.on(c,a.events[c]);if(a.filters)for(c in a.filters)this.addFilter(c,a.filters[c]);f&&f.debug&8&&console.log("mbrApp.regExtension"+a.name);return!0};e.prototype.rmExtension=e.prototype.removeExtension=function(a){if(!k[a])return!1;var b=k[a].global;if(b)for(var c in b)this.k&&delete this.k;delete k[a];return!0};
e.prototype.bridgeInit=function(){this.fireOnce("bridgeInit")};var n=0;e.prototype.uniqNum=function(){return n++};e.prototype.resetUniqNum=function(a){n=0;a&&this.Core.resetUniqNum()};window.mbrApp=new e;f.setOnReady(function(){f.bind("drop",function(a){for(var b in a)window.mbrApp.fire("incomingFile",a[b])});g(function(){window.mbrApp.bridgeInit()})});return window.mbrApp},["jQuery","Bridge"]);
