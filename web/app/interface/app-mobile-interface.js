var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(d,a,e){d instanceof String&&(d=String(d));for(var g=d.length,l=0;l<g;l++){var n=d[l];if(a.call(e,n,l,d))return{i:l,v:n}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,a,e){d!=Array.prototype&&d!=Object.prototype&&(d[a]=e.value)};$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(d,a,e,g){if(a){e=$jscomp.global;d=d.split(".");for(g=0;g<d.length-1;g++){var l=d[g];l in e||(e[l]={});e=e[l]}d=d[d.length-1];g=e[d];a=a(g);a!=g&&null!=a&&$jscomp.defineProperty(e,d,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6","es3");
defineM("app-mobile-interface",function(d,a,e,g){function l(){var b=["click"],c;for(c in b)(function(b,f){var a=b.contentWindow["on"+f];b.contentWindow["on"+f]=function(c){a&&a(c);var d=document.createEvent("MouseEvents"),r=b.getBoundingClientRect();d.initMouseEvent(f,!0,!1,window,c.detail,c.screenX,c.screenY,c.clientX+r.left,c.clientY+r.top,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.button,null);b.dispatchEvent(d)}})(a.iframe,b[c])}var n=d("nav.app-navbar").innerHeight(),t=window.innerHeight-n,k=
window.innerWidth,m=a.$body.find("#mobile-blocks-manager"),p;a.regExtension({name:"mobile-interface",global:{$navbar:d(".app-navbar"),calcBlocksCoords:function(b){var c=[];if(0!==b.lenght)return b.each(function(a){a=d(b[a]);var f=a.offset().top;a=f+a.innerHeight();c.push([f,a])}),c},checkActiveBlock:function(b){var c=a.Core.$document.scrollTop(),d=Math.ceil(c+t/3),f=a.$body.find(".app-mobile-focus-block a h4"),q=a.Core.$template;if(b.length)if(0===c){var h=q.find(".app-component").eq(0);c=h.attr("data-app-component-id");
(h=h.find("section").attr("id"))&&f.attr("data-current-component",c).text(h.charAt(0).toUpperCase()+h.slice(1).replace(/\d/," $&"))}else for(var e=0,g=b.length;e<g;e++)h=q.find(".app-component").eq(e),c=h.attr("data-app-component-id"),h=h.find("section").attr("id"),b[e][0]<=d&&b[e][1]>=d&&h&&f.attr("data-current-component",c).text(h.charAt(0).toUpperCase()+h.slice(1).replace(/\d/," $&"));else f.removeAttr("data-current-component").text("Blocks")},setAdditionalPadding:function(b){var c=this.Core.$template.find("[data-app-component-id]"),
a=2/3*t-b.height()+1;c.each(function(b){d(this).removeAttr("style")});0<a&&b.attr("style","margin-bottom: "+a+"px")},scrollToComponent:function(b){var a=this,d=m.find(".preloader");b?(b=a.Core.$template.find('[data-app-component-id="'+parseInt(b)+'"]'),a.Core.$body.stop().animate({scrollTop:b.offset().top},0,function(){a.$componentsParams.removeData("app-params-btn");a.$body.removeClass("app-blocks-manager-open");d.remove()})):(a.$componentsParams.removeData("app-params-btn"),a.$body.removeClass("app-blocks-manager-open"),
d.remove())},showBlocksManager:function(b){this.fire("showBlocksManager");var a=this;setTimeout(function(){a.$body.addClass("app-blocks-manager-open");m.append(a.preloaderHTML);m.find(".preloader").hide();p=!1;a.renderBlocksManager();a.fire("showedBlocksManager")},0)},hideBlocksManager:function(b){this.fire("hideBlocksManager");var c=this,e=this.$body.find("#sortable-blocks-manager").children(),f=m.find(".preloader");p?function(q){var h=[];f.fadeIn(50);e.each(function(b){b=d(this).attr("data-block-id");
h.push(a.Core.getComponent(parseInt(b)))});c.Core.resultJSON[c.Core.currentPage].components=h;c.Core.render(void 0,c.scrollToComponent.bind(c,b))}(this.Core.resultJSON[this.Core.currentPage].components):c.scrollToComponent(b);this.fire("hiddenBlocksManager")},renderBlocksManager:function(){this.fire("renderBlocksManager");var b=this;m.find(".cont").empty();this.Core.$template.find(".app-component").each(function(a){a=b.Core.getComponent(d(this).attr("data-app-component-id"));var c=b.Core.$template.find('[data-app-component-id="'+
a._id+'"]').find("section").attr("id"),f=!0===a._alwaysTop;a='<div class="m-component'+(f?" is-top-block":"")+'" data-block-id="'+a._id+'"><div class="m-component__thumb"><img src="'+b.theme.path+"/components/"+a._name+'/thumb.png"></div><div class="m-component__name">'+c.charAt(0).toUpperCase()+c.slice(1).replace(/\d/," $&")+"</div>"+(f?"":'<div class="m-component__replace"><span class="mbr-icon-arrows-vertical"></span></div>')+"</div>";m.find(".cont").append(a)});m.find(".m-component").on("click",
function(a){a=d(a.target).closest(".m-component").attr("data-block-id");b.hideBlocksManager(a)});m.find("#sortable-blocks-manager").sortable({axis:"y",handle:".m-component__replace",items:"> div:not(.is-top-block)",stop:function(b,a){p=!0}});this.fire("renderedBlocksManager")}},events:{beforeAppLoad:function(){600<k||a.addFilter("addPage",function(b){if(b.hasClass("main-page"))return b;b.find("> a").append('<div class="m-page-sort"><span class="mbr-icon-arrows-vertical"></span></div>');return b})},
load:function(){var b=this,c;if(!(600<k)){l();b.$body.find("#app-pages-list, #app-projects-list").find(".app-layer-title").after('<div class="mobile-top-buttons btn-group"><div class="btn-group"><span class="mobile-app-project-clone btn"><i class="mbr-icon-copy"></i></span></div><div class="btn-group"><span class="mobile-app-page-project-settings btn"><i class="mbr-icon-cog"></i></span></div></div>');b.Core.on(["rendered","summernoteBlur","removedComponent","changedComponentPosition","changedComponentParams"],
function(){a.Core.$template.find("[data-app-component-id]").each(function(b){d(this).removeAttr("style")});a.setAdditionalPadding(a.Core.$template.find(".app-component").last());c=b.calcBlocksCoords(b.Core.$template.find("[data-app-component-id]"));b.checkActiveBlock(c)});a.Core.$window.on("click scroll",function(f){c=a.calcBlocksCoords(a.Core.$template.find("[data-app-component-id]"));b.checkActiveBlock(c);a.$body.find(".app-navbar").is(":visible")||("scroll"===f.type&&a.Core.$body.find(".sp-container").addClass("sp-hidden"),
d(f.target).is('[data-app-edit="content"], [data-app-edit="full"], [data-app-btn]')||d(f.target).closest('[data-app-edit="content"], [data-app-edit="full"], [data-app-btn]').length||d(f.target).closest(".popover").length||d(f.target).hasClass("popover")||(a.Core.$body.find(".popover").hide(),a.Core.$body.find(".dummyTopbar").hide(),a.$iframe.css("height",""),a.Core.$template.css("padding-top",""),a.Core.$template.find(".app-component:first .app-component-content .navbar-fixed-top").css("top",""),
a.$body.find(".app-navbar").show(),setTimeout(function(){a.Core.$template.find("[data-app-always-top] .app-component-content .navbar-fixed-top").css("transition","")},0),a.Core.$template.find("[data-app-component-id]").each(function(b){d(this).removeAttr("style")}),a.setAdditionalPadding(a.Core.$template.find(".app-component").last()),c=a.calcBlocksCoords(a.Core.$template.find("[data-app-component-id]")),a.checkActiveBlock(c),a.$template.find("[contenteditable]:focus").trigger("blur")))});b.Core.on("removedComponent",
function(){var a=b.Core.$template.find(".app-component").eq(0).attr("data-app-component-id");b.scrollToComponent(a)});b.$body.find("#edit-component-params").prepend('<div class="descr"><span class="app-layer-close mbr-icon-angle-left"></span><h4 class="app-layer-title"></h4></div>');b.$componentsLayer.prepend('<div class="descr"><span class="app-layer-close mbr-icon-angle-left"></span><h4 class="app-layer-title">Add Block</h4></div>');b.on("prepareComponentParams",function(a){a=b.Core.$template.find('[data-app-component-id="'+
a+'"]').find("section").attr("id");b.$body.find("#edit-component-params .descr .app-layer-title").html(a.charAt(0).toUpperCase()+a.slice(1).replace(/\d/," $&"))});b.$navbar.find(".sidebar-toggle").after('<ul class="nav navbar-nav navbar-blockname"><li class="app-mobile-focus-block"><a href="javascript:void(0)"><h4>Blocks</h4></a></li><li class="app-mobile-focus-block-icon"><a href="javascript:void(0)"><i class="mbr-icon-shapes"></i></a></li></ul>');b.$body.find(".nav.navbar-nav.navbar-right").append('<li class="app-mobile-params"><a href="javascript:void(0)"><i class="mbr-icon-cog"></i></a></li>');
b.$body.find(".app-mobile-params").on("click",function(a){b.Core.$template.find(".app-component").length&&(b.prepareComponentParams(b.$body.find(".app-mobile-focus-block a h4").attr("data-current-component")),setTimeout(function(){b.showComponentParams(null)},0))});b.on("showedComponentParams",function(){b.$body.find("#edit-component-params > .cont").append('<button type="button" id="removeComponent" class="btn pull-right btn-danger">'+e("Remove")+"</button>");b.$body.find("#removeComponent").on("click",
function(){b.confirmDlg(e("Remove Block?"),function(a){a&&(b.Core.removeComponent(b.$body.find(".app-mobile-focus-block h4").attr("data-current-component")),b.hideComponentParams())})})});b.$navbar.find(".navbar-blockname").on("click",function(){b.showBlocksManager()});b.on("renderedBlocksManager",function(){var a=b.$body.find(".app-mobile-focus-block a h4").attr("data-current-component"),c=m.find('.m-component[data-block-id="'+a+'"]');a&&(c.addClass("m-component__active"),0!==c.offset().top-67&&
d("#sortable-blocks-manager").animate({scrollTop:c.offset().top-67},500))});m.on("click",".app-layer-close",function(a){b.hideBlocksManager()});b.$body.find("#edit-component-params").on("click",".app-layer-close",function(a){b.hideComponentParams()});b.$body.find("#theme-settings").append('<div class="descr"><span class="app-layer-close mbr-icon-angle-left"></span><h4 class="app-layer-title">Site Styles</h4></div>');b.$body.find("#theme-settings .app-layer-close").on("click",function(a){b.closeThemeSettings()});
b.$componentsLayer.find(".app-layer-close").on("click",function(a){b.hideComponentsList()});var g=b.$sidebar.find(".top-sidebar-block");g.addClass("navbar").append('<span class="sidebar-mobile-close"><i class="i1"></i><i class="i2"></i></span><ul class="nav navbar-nav buttons-right"><li class="app-preview"><a href="javascript:void(0)"><i class="mbr-icon-eye"></i></a></li><li class="app-publish"><a href="javascript:void(0)"><i class="mbr-icon-upload"></i></a></li></ul>');g.find(".sidebar-mobile-close").on("click",
function(){b.closeSidebar()});b.$sidebar.find(".app-preview").on("click",function(){b.publish(!0)});b.$sidebar.find(".app-publish").on("click",function(){b.runPublishDlg(function(a){a&&b.publish(!1,a)})});b.$pagesList.on("click",".mobile-app-project-clone",function(a){a=b.$pagesList.find(".list li > a.active").closest("[data-page]").attr("data-page");var c=b.$pagesList.find(".list li > a.active > .page-thumb").clone();if(a){a=b.addPage(a);a.find("> a").prepend(c);b.$pagesList.find(".list .sortable-container").sortable("disable");
c=a.find("span:eq(0)");a.children("a").addClass("editing");c.attr("contenteditable","");var f=document.createRange(),d=window.getSelection();f.selectNodeContents(c[0]);d.removeAllRanges();d.addRange(f);a.children("a").click()}});b.$pagesList.on("click",".mobile-app-page-project-settings",function(a){a.preventDefault();a.stopPropagation();a=b.$pagesList.find(".list li > a.active").closest("[data-page]");b.showPageSettings(a)});b.$pageSettings.find(".app-layer-cont").append('<div class="form-group"><a class="m-remove-page btn btn-danger pull-right">'+
e("Remove Page")+"</a></div>");b.on("showedPageSettings",function(){b.$pageSettings.find(".app-layer-cont .m-remove-page").show();b.$pagesList.find('.list [data-page="'+b.currentPageSettings+'"]').closest("li").hasClass("main-page")&&b.$pageSettings.find(".app-layer-cont .m-remove-page").hide()});b.$pageSettings.on("click",".m-remove-page",function(a){a.preventDefault();a.stopPropagation();var c=b.$pagesList.find('.list [data-page="'+b.currentPageSettings+'"]').closest("li")[0];a=d(c).find("> a").attr("data-page")||
"";b.confirmDlg(e("Remove page $page name$?").replace("$page name$"," <strong>"+a+"</strong>"),function(a){a&&(b.removePage(c),b.$pageSettings.find(".app-layer-close").click())})});b.$projectsList.on("click",".mobile-app-project-clone",function(a){a.preventDefault();a.stopPropagation();var c=b.$projectsList.find(".list > li > div.active").closest("[data-url]");a=c.attr("data-url").replace("/project.mobirise","");c=c.attr("data-name")+"-clone";b.projectClone(a,c)});b.$projectsList.on("click",".mobile-app-page-project-settings",
function(a){a.preventDefault();a=b.$projectsList.find(".list > li > div.active").closest("[data-url]").attr("data-url")||"";b.openProjectSettings(a)});b.addFilter("additionalSiteSettings",function(a){return a+'<div class="form-group row clearfix"><div class="col-md-9 col-md-offset-3"><a class="m-remove-site btn btn-danger pull-right">'+e("Remove Site")+"</a></div></div>"});b.$body.on("click",".site-settings-modal .m-remove-site",function(a){a.preventDefault();a.stopPropagation();var c=b.$projectsList.find(".list > li > div.active").closest("[data-url]");
a=c.attr("data-url");var d=c.attr("data-path")||a;c=c.attr("data-name")||d;b.projectRemove(a,c)});b.addFilter("additionalSiteSettings",function(b){return(a.hasThemeSettings(a.theme.params)?'<div class="form-group row clearfix"><div class="col-md-9 col-md-offset-3"><a class="m-project-styles btn btn-info pull-right">'+e("Edit Site Styles")+"</a></div></div>":"")+b});b.$body.on("click",".site-settings-modal .m-project-styles",function(a){b.$body.find(".site-settings-modal").modal("hide");b.closeSidebar();
b.openThemeSettings()});b.$projectsList.append('<div class="app-import-project btn btn-fab btn-material-teal btn-raised no-select"><i class="mbr-icon-to-local-drive"></i></div>')}},loadedProject:function(){600<k||a.$projectsList.find("> .app-layer-title").html(a.escapeHtml(a.projectSettings.name))},changedProjectSettings:function(){600<k||a.$projectsList.find("> .app-layer-title").html(a.escapeHtml(a.projectSettings.name))},switchedPage:function(b){600<k||a.$pagesList.find("> .app-layer-title").html(a.escapeHtml(a.$navbarPageName.html()))},
changedPageSettings:function(b){600<k||a.$pagesList.find("> .app-layer-title").html(a.escapeHtml(a.$navbarPageName.html()))},showedPagesList:function(){if(!(600<k)){var b=a.Core.getPages(),c;for(c in b)b.hasOwnProperty(c)&&d(b[c].components).each(function(b,d){if(!0===d._alwaysTop)return!0;b=a.theme.path+"/components/"+d._name+"/thumb.png";a.$pagesList.find('.list li > [data-page="'+c+'"]').prepend('<div class="page-thumb"><img src='+b+" width=60></div>");return!1})}},showedProjectsList:function(){600<
k||g.getRecentsList(function(b){for(var c=0;c<b.length;c++){var e=b[c].path+"/project.mobirise";g.getLocalJSON(e,function(b){for(var c in b.pages){b.pages.hasOwnProperty(c)&&d(b.pages[c].components).each(function(c,d){if(!0===d._alwaysTop||0<=d._name.indexOf("menu"))return!0;c=g.path2app(a.getAddonDir(b.settings.theme.name))+"/components/"+d._name+"/thumb.png";a.$projectsList.find('.list > li[data-url="'+e+'"] .project-img').prepend("<img src="+c+" width=60>");return!1});break}})}})},hiddenPagesList:function(){600<
k||a.$pagesList.find(".list li > a > .page-thumb").remove()},toggleComponents:function(){600<k||(a.Core.$window.scroll(),a.$body.hasClass("app-blocks-manager-open")||(p=!1),a.hideBlocksManager())},openThemeSettings:function(){600<k||a.Core.$window.scroll()},modalDialogShow:function(b){if(!(600<k)){a.Core.$window.scroll();var c=b.find(".modal-footer");(b.hasClass("create-site-modal")||b.hasClass("crop-image-dialog")||b.hasClass("note-font-dialog")||b.hasClass("note-mbr-link-dialog"))&&c.is(":visible")&&
(c.find("> *:visible").length?b.find(".modal-body").addClass("mobile-padding"):c.addClass("hidden"));b.hasClass("create-site-modal")||b.find(".modal-header .modal-mobile-close").click(function(){c.find('[data-bb-handler="success"]').click();c.find('[data-bb-handler="insert"]').click()})}}}})},["jQuery","mbrApp","TR()","Bridge"]);
